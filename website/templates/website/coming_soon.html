{% extends 'base.html' %}
{% load static %}
{% block title %}Coming Soon to Fort Kent Cinema{% endblock %}
{% block description %}See whatâ€™s coming soon to Fort Kent Cinema! Stay up to date with upcoming movies, release dates, and trailers so you can plan your next night at the movies in Fort Kent, Maine.{% endblock %}">
{% block og_title %}Fort Kent Cinema | Coming Soon{% endblock %}">
{% block extra_css %}

<!-- FullCalendar CDN (v6) -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>



{% endblock %}
{% block content %}

    <div class="flex flex-col items-center justify-center m-2 ">
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
            {% for film in next_films %}
            <div class="max-w-full sm:max-w-[400px] flex flex-col items-center justify-center p-5 m-2 rounded-lg shadow-md bg-white">
                <div class="border-b border-gray-200 mb-5"><h3
                        class="text-base font-semibold text-gray-900 text-center">{{ film.title }}</h3></div>
                <div class="w-full aspect-w-16 aspect-h-9">
                    <iframe class="w-full h-full" src="https://www.youtube.com/embed/{{ film.youtube_id }}"
                            title="The Toxic Avenger" frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen=""></iframe>
                </div>
                <p class="text-center mt-4">Booking: {{ film.bookings.last.booking_start_date }} to {{ film.bookings.last.booking_end_date }}</p></div>
            {% endfor %}
        </div>
        <div class="w-full max-w-full sm:max-w-[600px] md:max-w-[900px] lg:max-w-[1090px] flex flex-col items-center justify-center p-2 sm:p-4 m-2 rounded-lg shadow-md bg-white">
        <div id="calendar" class="w-full max-w-full"></div>
        </div>
    </div>
    <script>
    document.addEventListener("DOMContentLoaded", function () {
      const calendarEl = document.getElementById("calendar");
      const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: "dayGridMonth",
        headerToolbar: {
          left: false,
          center: "title",
          right: "prev,next"
        },
        navLinks: true,
        nowIndicator: true,
        weekNumbers: false,
        selectable: false,
        eventTimeFormat: { hour: "numeric", minute: "2-digit", meridiem: "short" },
        events: "{% url "website:calendar_events" %}",   // <-- our JSON endpoint
        // timezone handling: let FullCalendar parse ISO; set your display zone:
        timeZone: "local", // or "America/New_York" if you want to lock it
        eventClick(info) {
          // Default behavior if a URL exists: open it.
          if (info.event.url) {
            info.jsEvent.preventDefault();
            window.location.href = info.event.url;
          } else {
            // Quick detail popup
            alert(`${info.event.title}\n${info.event.start?.toLocaleString()}${info.event.end ? " - " + info.event.end.toLocaleString() : ""}`);
          }
        },
      });

      calendar.render();
    });
  </script>
{% endblock content %}
